You live in a city consisting of 𝑛
intersections and 𝑚
streets connecting some pairs of intersections. You can travel in either direction on each street. No two streets
connect the same pair of intersections, and no street connects an intersection to itself. You can reach any intersection
from any other, possibly passing through some other intersections.

Every minute, you can board a bus at intersection 𝑢𝑖
and travel for 𝑙𝑖1
minutes to intersection 𝑣𝑖
. Conversely, you can travel from intersection 𝑣𝑖
to intersection 𝑢𝑖
in 𝑙𝑖1
minutes. You can only board and exit the bus at intersections. You can only board the bus at an intersection if you are
currently there.

You can also walk along each street, which takes 𝑙𝑖2>𝑙𝑖1
minutes.

You can make stops at intersections.

You live at intersection number 1
. Today you woke up at time 0
, and you have an important event scheduled at intersection number 𝑛
, which you must reach no later than time 𝑡0
. You also have a phone call planned that will last from 𝑡1
to 𝑡2
minutes (𝑡1<𝑡2<𝑡0
).

During the phone call, you cannot ride the bus, but you can walk along any streets, make stops, or stay at home. You can
exit the bus at minute 𝑡1
and board the bus again at minute 𝑡2
.

Since you want to get enough sleep, you became curious — how late can you leave home to have time to talk on the phone
and still not be late for the event?