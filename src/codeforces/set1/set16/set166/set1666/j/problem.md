Julia's ğ‘›
 friends want to organize a startup in a new country they moved to. They assigned each other numbers from 1 to ğ‘›
 according to the jobs they have, from the most front-end tasks to the most back-end ones. They also estimated a matrix ğ‘
, where ğ‘ğ‘–ğ‘—=ğ‘ğ‘—ğ‘–
 is the average number of messages per month between people doing jobs ğ‘–
 and ğ‘—
.

Now they want to make a hierarchy tree. It will be a binary tree with each node containing one member of the team. Some member will be selected as a leader of the team and will be contained in the root node. In order for the leader to be able to easily reach any subordinate, for each node ğ‘£
 of the tree, the following should apply: all members in its left subtree must have smaller numbers than ğ‘£
, and all members in its right subtree must have larger numbers than ğ‘£
.

After the hierarchy tree is settled, people doing jobs ğ‘–
 and ğ‘—
 will be communicating via the shortest path in the tree between their nodes. Let's denote the length of this path as ğ‘‘ğ‘–ğ‘—
. Thus, the cost of their communication is ğ‘ğ‘–ğ‘—â‹…ğ‘‘ğ‘–ğ‘—
.

Your task is to find a hierarchy tree that minimizes the total cost of communication over all pairs: âˆ‘1â‰¤ğ‘–<ğ‘—â‰¤ğ‘›ğ‘ğ‘–ğ‘—â‹…ğ‘‘ğ‘–ğ‘—
.

### ideas
1. è¿™æ£µæ ‘åœ¨ä¸­åºè®¿é—®çš„æ—¶å€™ï¼Œå¾—åˆ°çš„å°±æ˜¯1,2,3....n 
2. å‡è®¾iæ˜¯rootï¼Œé‚£ä¹ˆ[1...i-1]æ˜¯å®ƒçš„å·¦å­æ ‘ï¼Œ[i+1...n]æ˜¯å®ƒçš„å³å­æ ‘
3. dp[i...j]æ˜¯è¿™æ®µåºåˆ—ç»„æˆæ ‘çš„æœ€å°å€¼ï¼Œ
4. é‚£ä¹ˆdp[i][j] = ä»¥kä¸ºrootï¼Œ dp[i...k-1] + cost from k + dp[k+1...j] + cost from k çš„æœ€å°å€¼
5. cost from k = c[i][k] * d[i][k] + c[i+1][k] * d[i+1..k] + ..
6.   c[i][k]è¿™ä¸ªæ˜¯å·²çŸ¥çš„ï¼Œé—®é¢˜æ˜¯ d[i][k], 
7. è¿™é‡Œå› ä¸ºä¸çŸ¥é“[i...k-1]çš„rootæ˜¯å“ªä¸ªï¼Œæ‰€ä»¥ä¹Ÿæ— ä»çŸ¥é“è¿™ä¸ªé«˜åº¦æ˜¯ä»€ä¹ˆ
8. è¿˜å¾—å˜å½¢
9. c[i][j] * d[i][j] = c[i][j] * (d[i] - d[j]) (jæ˜¯root)
10. = c[i][j] * d[i] - c[i][j] * d[j]
11. ä¸Šé¢çš„åˆ†æä¸å¤§å¯¹ã€‚ æ‰€æœ‰çš„ï¼ˆiï¼Œ jï¼‰pair éƒ½éœ€è¦æ²Ÿé€šï¼Œå¹¶ä¸æ˜¯åªæœ‰ä¸Šä¸‹çº§éœ€è¦æ²Ÿé€š
12. å‡è®¾ç”±[i..j]æ®µç»„æˆçš„å­æ ‘ï¼Œå®ƒå¯¹æ•´ä½“çš„è´¡çŒ®æ˜¯å¤šå°‘å‘¢ï¼Ÿ
13. å®ƒå†…éƒ¨çš„ï¼Œå‡è®¾å·²ç»çŸ¥é“äº†ã€‚ä¸å»ç®¡å®ƒ
14. å®ƒå’Œå¤–éƒ¨çš„å‘¢ï¼Ÿå‡è®¾æœ‰ä¸€ä¸ªk
15. c[i][k] * d[i][k] + c[i+1][k] * d[i+1][k] + .... + c[j][k] * d[j][k]
16. c[i][k] * (d[i] - d[r] + d[r][k]) çš„è·ç¦»
17. c[i][k] * (d[i] - d[r]) + c[i][k] * d[r][k]çš„è·ç¦»
18. å‰åŠéƒ¨åˆ†å®Œå…¨ç”±è¿™é¢—å­æ ‘çš„ç»“æ„å†³å®š(å’Œkæ˜¯æ— å…³çš„)
19. æ„Ÿè§‰è¿™é‡Œæ…åœ¨ä¸€èµ·äº†ï¼Œæœ‰ç‚¹ä¹±ã€‚ç¼“ç¼“
20. è€ƒè™‘ä¸€ä¸ªå­æ ‘uï¼Œå®ƒçš„å·¦å³å­æ ‘ä¸­çš„èŠ‚ç‚¹çš„è´¡çŒ®è¦æ€ä¹ˆè®¡ç®—å‘¢ï¼Ÿ
21. c[i][j] * (d[i] + d[j] - 2 * d[u]) (uæ˜¯å­æ ‘æ ¹èŠ‚ç‚¹)
22. ä¹Ÿå°±æ˜¯è¯´åœ¨ç¡®å®šäº†å­æ ‘ï¼Œä¸”è¿™ä¸ªå­æ ‘çš„æ ¹èŠ‚ç‚¹æ˜¯uçš„æƒ…å†µä¸‹ï¼Œ c[i][j] * (d[i] + d[j]) 
23. æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªè¶Šå°è¶Šå¥½ï¼Œ
24. c[i][j]æ˜¯ç¡®å®šçš„ï¼Œå…¶å®å°±æ˜¯d[i] + d[j]è¶Šå°è¶Šå¥½
25. è¿™é‡Œçš„é—®é¢˜å°±åœ¨äºï¼Œæ²¡æœ‰åŠæ³•åŒæ—¶çŸ¥é“(i, j)
26. ä¸”åªæœ‰å½“å‡ºç°äº†jçš„æ—¶å€™
27. åœ¨ç¡®å®šuçš„æ—¶å€™ï¼Œå¯¹äºå·¦å­æ ‘çš„rootï¼Œå…¶å®æ˜¯è¦æ±‚ï¼Œæ‰€æœ‰ c[i][j] çš„ å’Œæœ€å¤§çš„é‚£ä¸ªiæœ€ä¸ºå·¦å­æ ‘çš„root
28. è¿˜æ˜¯ä¸å¤§é€š å‡è®¾ a, b æ˜¯rootå·¦è¾¹çš„ä¸¤ä¸ªèŠ‚ç‚¹
29. s[a][..] > s[b][..], ä½†æ˜¯åœ¨æœ€ä¼˜ç­”æ¡ˆä¸­bæ˜¯rootï¼Œ è€Œaä¸æ˜¯, é€šè¿‡äº¤æ¢abæ˜¯ä¸æ˜¯èƒ½å¾—åˆ°æ›´å¥½çš„ç­”æ¡ˆï¼Ÿ
30. å› ä¸ºbæ˜¯rootï¼Œæ‰€ä»¥åœ¨å¤–éƒ¨çš„èŠ‚ç‚¹åˆ°bçš„è·ç¦»è¦å°äºåˆ°açš„è·ç¦»ï¼Œå‡è®¾aå°±æ˜¯bçš„ä¸€ä¸ªchild
31. äº¤æ¢åçš„æ”¶ç›Š(å¯¹å¤–éƒ¨èŠ‚ç‚¹æ¥è¯´) = -s[a][..] + s[b][..] < 0 ï¼ˆæ‰€ä»¥costæ›´å°äº†ï¼‰
32.  ä½†æ˜¯å¯¹äºå†…éƒ¨æ¥è¯´ï¼Œbè¦å˜æˆaçš„æ–°çš„å³å­æ ‘ï¼ŒåŸæ¥açš„å³å­æ ‘å˜æˆäº†bçš„å·¦å­æ ‘
33.  å‘ç”Ÿå˜åŒ–çš„ï¼Œåªæœ‰açš„åŸæ¥çš„å³å­æ ‘éƒ¨åˆ†ï¼Œå®ƒä»¬ç¦»açš„è·ç¦»å¢åŠ äº†ï¼Œä½†æ˜¯åˆ°bçš„è·ç¦»å‡å°‘äº†
34.  +c[x][a] - c[x][b] (xå…¶å®å°±æ˜¯ aå’Œbä¸­é—´çš„èŠ‚ç‚¹)
35.   å¦‚æœé€‰aä½œbçš„parentï¼Œ 2 * c[x][a] + c[x][b], å¦‚æœé€‰bä½œaçš„parent, c[x][a] + 2 * c[x][b]
36.   æ‰€ä»¥å¦‚æœ c[x][a] < c[x][b] çš„è¯ï¼Œ aä½œä¸ºparentæ›´æœ‰åˆ©
37.   ä½†æ˜¯åŒæ—¶åœ¨å­æ ‘uå¤–éƒ¨çš„èŠ‚ç‚¹ä¹Ÿæœ‰å½±å“ï½
38. å¦‚æœaæ˜¯bçš„parentï¼Œåœ¨å­æ ‘uå¤–éƒ¨çš„åˆ°açš„è·ç¦»æ¯”åˆ°bçš„è·ç¦»å°1ï¼Œæ‰€ä»¥c[y][a] + 2 * c[y][b], åè¿‡æ¥çš„è¯å°±æ˜¯ 2 * c[y][a] + c[y][b]
39. åŒæ ·çš„å¦‚æœ c[y][a] > c[y][b] çš„è¯ï¼Œè®©aä½œä¸ºparentæ›´æœ‰åˆ©
40. é‚£è¿™é‡Œå°±æœ‰ç‚¹éº»çƒ¦äº†ï¼Œé¦–å…ˆyè¿™ä¸ªä¸å¥½ç¡®å®šï¼ˆå®ƒä¾èµ–å½“å‰çš„æ‰€è¯´çš„å­æ ‘çš„rootæ˜¯ä»€ä¹ˆï¼‰ç„¶åå¯¹äºä¸¤ä¸ªa,b ï¼ˆä¸ç›¸é‚»)
41. å¦‚æœ s[y][a] > s[y][b], ä¸”s[x][a] < s[x][b] ï¼ˆyæ˜¯rootå¤–é¢çš„èŠ‚ç‚¹ï¼Œxæ˜¯aï¼Œbä¸­é—´çš„èŠ‚ç‚¹ï¼‰æ—¶aä½œä¸ºrootæ›´å¥½
42. s[y][a] - s[x][a] > s[y][b] - s[x][b]æ—¶ï¼Œaæ›´åº”è¯¥é«˜ä¸€ç‚¹
43. è¿™é‡Œè¿˜æ˜¯ä¸å¤§å¯¹çš„ã€‚ã€‚ã€‚å†æƒ³æƒ³
44. è€ƒè™‘rootï¼Œåº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå‡è®¾æœ‰ä¸¤ä¸ªaï¼Œbå®ƒä»¬åšrootæœ‰ä»€ä¹ˆä¸åŒ
45. é¦–å…ˆaå‰é¢å’Œbåé¢çš„ï¼Œä¼¼ä¹ä¸å—å½±å“ã€‚åªæœ‰ä¸­é—´çš„éƒ¨åˆ†å—å½±å“ã€‚è¿™ä¸ªå°±æ˜¯ä¸Šé¢çš„å¦‚æœs[a][x] < s[b][x] é‚£ä¹ˆaä½œä¸ºrootæ›´åˆç†
46. é‚£ä¹ˆè¿™æ ·æ˜¯ä¸æ˜¯å°±å¯ä»¥é€’å½’ä¸‹å»äº†ï¼Ÿ
47. å¯¹äº[l...r]ä¸­é—´çš„aå’Œbï¼Œå¯¹æ‰€æœ‰çš„aï¼Œbè¿›è¡Œæ¯”å¯¹ï¼Œæ‰¾åˆ°å®ƒä»¬çš„å…³ç³»ï¼Œç„¶åæ ¹æ®è¿™ä¸ªå…³ç³»ï¼Œæ‰¾åˆ°å…¥åº¦ä¸º0çš„èŠ‚ç‚¹
48. ä¸”a,bçš„å…³ç³»ï¼Œä»…éœ€è¦æ ¹æ®å®ƒä»¬ä¸­é—´çš„éƒ¨åˆ†è¿›è¡Œè®¡ç®—ã€‚æ‰€ä»¥è¿™ä¸ªæ˜¯å¯ä»¥æå‰ç®—å¥½çš„ã€‚