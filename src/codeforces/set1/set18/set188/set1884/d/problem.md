You are given an array of integers ğ‘1,ğ‘2,â€¦,ğ‘ğ‘›
.

A pair of integers (ğ‘–,ğ‘—)
, such that 1â‰¤ğ‘–<ğ‘—â‰¤ğ‘›
, is called good, if there does not exist an integer ğ‘˜
 (1â‰¤ğ‘˜â‰¤ğ‘›
) such that ğ‘ğ‘–
 is divisible by ğ‘ğ‘˜
 and ğ‘ğ‘—
 is divisible by ğ‘ğ‘˜
 at the same time.

Please, find the number of good pairs.




### solution

æ•´ä½“æ€è·¯
è€ƒè™‘æœ‰å¤šå°‘å¯¹ (a[i],a[j]) çš„ GCD æ°å¥½ç­‰äº kï¼Œå°†å…¶è®°ä½œ res[k]ã€‚
å¦‚æœ a ä¸­æ²¡æœ‰æ•°èƒ½æ•´é™¤ kï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠ res[k] åŠ å…¥ç­”æ¡ˆã€‚


å¦‚ä½•è®¡ç®— res[k]
ç»Ÿè®¡ a ä¸­æ¯ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•° cntã€‚
æšä¸¾ k åŠå…¶å€æ•°ï¼ˆk,2k,3k,...ï¼‰ï¼Œç´¯åŠ è¿™äº›æ•°çš„å‡ºç°æ¬¡æ•°ï¼Œè®°ä½œ cã€‚
è¿™ c ä¸ªæ•°ä¸­ï¼Œä»»é€‰ä¸¤ä¸ªæ•°çš„ GCDï¼Œä¸€å®šæ˜¯ k çš„å€æ•°ã€‚æ‰€ä»¥ c*(c-1)/2 å°±æ˜¯ GCD ç­‰äº k,2k,3k,... çš„æ•°å¯¹çš„ä¸ªæ•°ã€‚
ä½†æˆ‘ä»¬è¦è®¡ç®—çš„æ˜¯ã€æ°å¥½ã€‘ç­‰äº k çš„æ•°å¯¹ä¸ªæ•°ï¼Œæ‰€ä»¥è¦å‡å» GCD æ°å¥½ç­‰äº 2k,3k,... çš„æ•°å¯¹ä¸ªæ•°ï¼Œå¾—
res[k] = c*(c-1)/2 - res[2k] - res[3k] - ...
è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç”¨ O(nlogn) çš„æšä¸¾å®Œæˆã€‚ï¼ˆè°ƒå’Œçº§æ•°ï¼‰
æ³¨æ„è¦å€’åºæšä¸¾ kï¼Œå› ä¸ºè½¬ç§»æ¥æºæ˜¯æ¯” k å¤§çš„æ•°ã€‚

å¦‚ä½•è®¡ç®— a ä¸­æ˜¯å¦æœ‰æ•´é™¤ k çš„æ•°ï¼ˆa ä¸­æ˜¯å¦æœ‰ k çš„å› å­ï¼‰
å¦‚æœ cnt[i] > 0ï¼Œé‚£ä¹ˆå¯¹äº i,2i,3i,... è¿™äº›æ•°æ¥è¯´ï¼Œa ä¸­éƒ½æœ‰è¿™äº›æ•°çš„å› å­ã€‚æ ‡è®°è¿™äº›æ•°ã€‚
è¿™ä¸ªè¿‡ç¨‹ä¹Ÿå¯ä»¥ç”¨ O(nlogn) çš„æšä¸¾å®Œæˆã€‚

æ³¨æ„ä½¿ç”¨ 64 ä½æ•´æ•°ã€‚
å¦‚æœè§‰å¾—ä»£ç æœ‰äº›æ…¢ï¼Œå¯ä»¥åŠ ä¸ªå¿«è¯»æ¥æé€Ÿã€‚
