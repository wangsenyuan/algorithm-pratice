Let ğ‘›
be an integer. Consider all permutations on integers 1
to ğ‘›
in lexicographic order, and concatenate them into one big sequence ğ‘
. For example, if ğ‘›=3
, then ğ‘=[1,2,3,1,3,2,2,1,3,2,3,1,3,1,2,3,2,1]
. The length of this sequence will be ğ‘›â‹…ğ‘›!
.

Let 1â‰¤ğ‘–â‰¤ğ‘—â‰¤ğ‘›â‹…ğ‘›!
be a pair of indices. We call the sequence (ğ‘ğ‘–,ğ‘ğ‘–+1,â€¦,ğ‘ğ‘—âˆ’1,ğ‘ğ‘—)
a subarray of ğ‘
. Its length is defined as the number of its elements, i.e., ğ‘—âˆ’ğ‘–+1
. Its sum is the sum of all its elements, i.e., âˆ‘ğ‘—ğ‘˜=ğ‘–ğ‘ğ‘˜
.

You are given ğ‘›
. Find the number of subarrays of ğ‘
of length ğ‘›
having sum ğ‘›(ğ‘›+1)2
. Since this number may be large, output it modulo 998244353
(a prime number).

### ideas

1. æ˜¯ä¸€ä¸ªå¾ˆè´¹è„‘çš„é¢˜ç›®
2. è€ƒè™‘ä¸Šé¢1ï¼Œ2ï¼Œ3çš„ä¾‹å­ï¼Œ sum n * (n + 1) / 2 è¿™ä¸ªå°±æ˜¯æ•°ç»„pçš„sum = 6
3. æ¯ä¸ªç‹¬ç«‹çš„æ®µï¼Œä¹Ÿå°±æ˜¯ä»0, n, 2 * n ... i * n çš„né•¿çš„éƒ½æ˜¯æ»¡è¶³æ¡ä»¶çš„ï¼Œ è¿™ä¸ªæ•°é‡æ˜¯ n!
4. ç„¶åå‰©ä¸‹çš„æ˜¯ï¼Œåœ¨è¦†ç›–ä¸¤æ®µçš„
5. æ¯”å¦‚ä¸Šé¢çš„ 2,3,1
6. è¿™ä¸ªæœ‰ä¸ªç®€å•çš„è§‚å¯Ÿï¼Œå°±æ˜¯å¯¹äºåé¢ä¸€æ®µæ˜¯1å¼€å¤´çš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆ2ï¼Œ3ï¼Œ1ï¼Œæˆ–è€… 3,2,1
7. ä¹Ÿå°±æ˜¯å‰é¢çš„2,3 çš„ ä¸ªæ•°çš„é˜¶ä¹˜ (n-1)!, ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯3, 2, 1 ä¸ä¼šå‡ºç°
8. n * (n - 1) ! - (n-1)! (åé¢ä¸€é¡¹è¡¨ç¤ºçš„æ˜¯æ¯ä¸ªblockå¼€å§‹çš„éƒ¨åˆ†)
9. 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ1ï¼Œ2ï¼Œ4ï¼Œ3ï¼Œ1ï¼Œ3ï¼Œ2ï¼Œ4ï¼Œ1ï¼Œ4ï¼Œ2ï¼Œ3ï¼Œ1ï¼Œ4ï¼Œ3ï¼Œ2
10. æœ‰å‡ºç°ä¸€ä¸ªæ–°çš„æƒ…å†µï¼Œä¸Šé¢ 2,3,1,4
11. ä»¥1å¼€å¤´çš„ï¼Œç„¶å1ï¼Œ2å¼€å¤´ï¼Œç„¶å1ï¼Œ3ï¼Œç„¶å1ï¼Œ4ï¼Œ ç„¶å1ï¼Œ2ï¼Œ3ï¼Œ1ï¼Œ2ï¼Œ4ï¼Œ 1ï¼Œ3ï¼Œ4ï¼Œ ç„¶å 1ï¼Œ2ï¼Œ3ï¼Œ4
12. æ­£éš¾åˆ™åå—ï¼Ÿ
13. ä»¥1å¼€å¤´çš„æœ‰(n-1)!,
14. é™¤äº†ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªï¼Œå‰©ä¸‹çš„ (n-1)! - 1 å’Œ1å°±å¯ä»¥ç»„æˆä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„
15. ç„¶åæ˜¯1ï¼Œ2å¼€å¤´çš„ï¼Œï¼ˆn-2)! - 1
16. 1, 2, 3, 4, 1, 2, 4, 3, 1, ? ä¹Ÿæ˜¯æ»¡è¶³æ¡ä»¶çš„
17. n! + n * ((n-1)! - 1) + n * (n - 1) * ((n - 2)! - 1) ..
18. å¯¹äº4ï¼Œ 24 + 4 * (6 - 1) + 4 * 3 * (2 - 1) = 24 + 20 + 12